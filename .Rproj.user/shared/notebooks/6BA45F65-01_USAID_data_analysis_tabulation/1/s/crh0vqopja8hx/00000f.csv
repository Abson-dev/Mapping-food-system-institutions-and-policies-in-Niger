"0","# This function aims at providing customized statistics in the table that "
"0","# with be produced using the gtsummary package"
"0","# Basically the gtsummary does not include such a function "
"0","add_by_n <- function(data, variable, by, tbl, ...) {"
"0","  data %>%"
"0","    select(all_of(c(variable, by))) %>%"
"0","    dplyr::group_by(.data[[by]]) %>%"
"0","    dplyr::summarise_all(~sum(!is.na(.))) %>%"
"0","    rlang::set_names(c(""by"", ""variable"")) %>%"
"0","    dplyr::left_join("
"0","      tbl$df_by %>% select(by, by_col),"
"0","      by = ""by"""
"0","    ) %>%"
"0","    mutate("
"0","      by_col = paste0(""add_n_"", by_col),"
"0","      variable = style_number(variable)"
"0","    ) %>%"
"0","    select(-by) %>%"
"0","    tidyr::pivot_wider(names_from = by_col, "
"0","                       values_from = variable)"
"0","}"
"0",""
